# List of metrics

Both the API service and the collector service expose all metrics generated by the standard Go client for Prometheus,
e.g. `go_memstats_alloc_bytes` for memory usage or `go_goroutines` for goroutine count.

## API service

The API service exposes the standard HTTP metrics generated by the standard Go client for Prometheus:

| Type | Metric | Labels |
| --- | --- | --- |
| Summary | `http_request_duration_microseconds` ||
| Summary | `http_request_size_bytes` ||
| Counter | `http_requests_total` | `code`, `method` |
| Summary | `http_response_size_bytes` ||

## Collector service

The collector service exposes the following metrics by default:

| Type | Metric | Labels |
| --- | --- | --- |
| Counter | `limes_successful_scrapes` | `os_cluster`, `service`, `service_name` (counts projects) |
| Counter | `limes_failed_scrapes` | `os_cluster`, `service`, `service_name` (counts projects) |
| Counter | `limes_successful_domain_discoveries` | `os_cluster` |
| Counter | `limes_failed_domain_discoveries` | `os_cluster` |
| Counter | `limes_successful_project_discoveries` | `os_cluster`, `domain`, `domain_id` |
| Counter | `limes_failed_project_discoveries` | `os_cluster`, `domain`, `domain_id` |
| Counter | `limes_successful_capacity_scrapes` | `os_cluster`, `capacitor` |
| Counter | `limes_failed_capacity_scrapes` | `os_cluster`, `capacitor` |

The `limes_failed_scrapes` metric is particularly useful for assessing the continued operation of backend services
(specifically their API parts). If you can do only one alert on Limes metrics, alert on `limes_failed_scrapes`.
Alerts on `limes_failed_{domain,project}_discoveries` are very useful, too, but less important.

`os_cluster` represents the OpenStack cluster configured in the [clusters configuration section](config.md#section-clusters)

For the scraping metrics, the `service` label contains the type of the backend service in question (as stated in the Keystone
service catalog), and the `service_name` label contains the product name (in lower case) of the reference implementation
of this service, for instance, `service_name="nova"` for `service="compute"`.

## Data metrics

With the configuration option `collector.data_metrics` set to true, the collector service will report the following
additional metrics:

| Type | Metric | Labels |
| --- | --- | --- |
| Gauge | `limes_cluster_capacity` | `os_cluster`, `service`, `resource` |
| Gauge | `limes_domain_quota` | `os_cluster`, `service`, `resource`, `domain`, `domain_id` |
| Gauge | `limes_project_backendquota` | `os_cluster`, `service`, `resource`, `domain`, `domain_id`, `project`, `project_id` |
| Gauge | `limes_project_quota` | `os_cluster`, `service`, `resource`, `domain`, `domain_id`, `project`, `project_id` |
| Gauge | `limes_project_usage` | `os_cluster`, `service`, `resource`, `domain`, `domain_id`, `project`, `project_id` |

`os_cluster` represents the OpenStack cluster configured in the [clusters configuration section](config.md#section-clusters)

### Quota/capacity plugins

Plugins may emit their own metrics when enabled. Refer to the documentation of [the quota
plugins](config.md#supported-service-types) and [the capacity plugins](config.md#available-capacity-plugins) for
details.
